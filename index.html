<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meal Planner</title>
</head>
<body>
  <h2>Create Client Profile</h2>
  <label>Name: <input type="text" id="name"></label><br>
  <label>Age: <input type="number" id="age"></label><br>
  <label>Gender: 
    <select id="gender">
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select>
  </label><br>
  <label>Weight (kg): <input type="number" id="weight"></label><br>
  <label>Height (cm): <input type="number" id="height"></label><br>
  <label>Activity: 
    <select id="activity">
      <option value="sedentary">Sedentary</option>
      <option value="light">Lightly Active</option>
      <option value="moderate">Moderately Active</option>
      <option value="active">Active</option>
      <option value="very">Very Active</option>
    </select>
  </label><br>

  <h3>Macro Split (%)</h3>
  <label>Protein: <input type="number" id="proteinSplit" value="40"></label><br>
  <label>Carbs: <input type="number" id="carbsSplit" value="40"></label><br>
  <label>Fat: <input type="number" id="fatSplit" value="20"></label><br>

  <h3>Restrictions</h3>
  <select id="restrictions" multiple>
    <option value="meat">Meat</option>
    <option value="pork">Pork</option>
    <option value="chicken">Chicken</option>
    <option value="fish">Fish</option>
    <option value="veggies">Veggies</option>
    <option value="rice">Rice</option>
    <option value="dairy">Dairy</option>
    <option value="eggs">Eggs</option>
    <option value="gluten">Gluten</option>
  </select><br><br>

  <button onclick="saveProfile()">Save Profile</button>
  <div id="profileInfo"></div>

  <h3>Meal Plan</h3>
  <button onclick="generateMealPlan()">Generate 14-Day Plan</button>
  <div id="mealPlan"></div>

  <button onclick="downloadPDF()">Download PDF</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    let profile = null;

    // nutrition database (per 100g)
    const nutritionDB = {
      chickenBreast: { cal: 165, protein: 31 },
      riceCooked: { cal: 130, protein: 2.5 },
      salmon: { cal: 208, protein: 20 },
      egg: { cal: 155, protein: 13 },
      banana: { cal: 89, protein: 1.1 },
      tofu: { cal: 76, protein: 8 },
      beefLean: { cal: 250, protein: 26 },
      sweetPotato: { cal: 86, protein: 1.6 },
      yogurtLowFat: { cal: 63, protein: 5 },
      veggies: { cal: 35, protein: 2 },
      bread: { cal: 265, protein: 9 },
      oats: { cal: 389, protein: 17 }
    };

    // meals
    const mealDB = {
      breakfast: [
        { name: "Chicken Omelette", ingredients: [{ item: "egg", grams: 120 }, { item: "chickenBreast", grams: 80 }] },
        { name: "Oats with Banana", ingredients: [{ item: "oats", grams: 50 }, { item: "banana", grams: 100 }] },
        { name: "Yogurt + Sweet Potato", ingredients: [{ item: "yogurtLowFat", grams: 150 }, { item: "sweetPotato", grams: 100 }] }
      ],
      lunch: [
        { name: "Grilled Chicken + Rice", ingredients: [{ item: "chickenBreast", grams: 150 }, { item: "riceCooked", grams: 100 }] },
        { name: "Salmon + Veggies", ingredients: [{ item: "salmon", grams: 150 }, { item: "veggies", grams: 100 }] },
        { name: "Beef + Sweet Potato", ingredients: [{ item: "beefLean", grams: 150 }, { item: "sweetPotato", grams: 120 }] }
      ],
      dinner: [
        { name: "Chicken + Veggies", ingredients: [{ item: "chickenBreast", grams: 150 }, { item: "veggies", grams: 150 }] },
        { name: "Tofu + Rice", ingredients: [{ item: "tofu", grams: 150 }, { item: "riceCooked", grams: 100 }] },
        { name: "Salmon + Salad", ingredients: [{ item: "salmon", grams: 150 }, { item: "veggies", grams: 120 }] }
      ],
      snack: [
        { name: "Banana", ingredients: [{ item: "banana", grams: 100 }] },
        { name: "Boiled Egg", ingredients: [{ item: "egg", grams: 60 }] },
        { name: "Banana + Egg", ingredients: [{ item: "banana", grams: 80 }, { item: "egg", grams: 60 }] },
        { name: "Salad", ingredients: [{ item: "veggies", grams: 120 }] }
      ]
    };

    function calcMealNutrition(meal) {
      let totalCal = 0, totalProtein = 0;
      meal.ingredients.forEach(ing => {
        const nut = nutritionDB[ing.item];
        totalCal += (nut.cal * ing.grams) / 100;
        totalProtein += (nut.protein * ing.grams) / 100;
      });
      meal.cal = Math.round(totalCal);
      meal.protein = Math.round(totalProtein);
      meal.grams = meal.ingredients.map(ing => `${ing.grams}g ${ing.item}`).join(" + ");
    }

    function saveProfile() {
      const name = document.getElementById("name").value;
      const age = document.getElementById("age").value;
      const gender = document.getElementById("gender").value;
      const weight = parseFloat(document.getElementById("weight").value);
      const height = parseFloat(document.getElementById("height").value);
      const activity = document.getElementById("activity").value;

      profile = {
        name,
        age,
        gender,
        weight,
        height,
        activity,
        macroSplit: {
          protein: parseInt(document.getElementById("proteinSplit").value),
          carbs: parseInt(document.getElementById("carbsSplit").value),
          fat: parseInt(document.getElementById("fatSplit").value)
        },
        restrictions: Array.from(document.getElementById("restrictions").selectedOptions).map(opt => opt.value)
      };

      document.getElementById("profileInfo").innerText = `
        Name: ${profile.name}
        Age: ${profile.age}
        Gender: ${profile.gender}
        Weight: ${profile.weight} kg
        Height: ${profile.height} cm
        Activity: ${profile.activity}
        Restrictions: ${profile.restrictions.length ? profile.restrictions.join(", ") : "None"}
        Macro Split: P${profile.macroSplit.protein}% | C${profile.macroSplit.carbs}% | F${profile.macroSplit.fat}%
      `;
    }

    function generateMealPlan() {
      if (!profile) {
        alert("Save profile first!");
        return;
      }
      let output = "";
      for (let d = 1; d <= 14; d++) {
        output += `<h4>Day ${d}</h4>`;
        ["breakfast", "lunch", "dinner", "snack"].forEach(type => {
          const meals = mealDB[type];
          const meal = meals[(d - 1) % meals.length];
          calcMealNutrition(meal);
          output += `<b>${type}:</b> ${meal.name} (${meal.grams}) - ${meal.cal} kcal | ${meal.protein}g protein<br>`;
        });
      }
      document.getElementById("mealPlan").innerHTML = output;
    }

    async function downloadPDF() {
      if (!profile) {
        alert("Save profile first!");
        return;
      }
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 10;

      doc.text(`Meal Plan for ${profile.name}`, 10, y); y += 10;

      for (let d = 1; d <= 14; d++) {
        doc.text(`Day ${d}`, 10, y); y += 8;
        ["breakfast", "lunch", "dinner", "snack"].forEach(type => {
          const meals = mealDB[type];
          const meal = meals[(d - 1) % meals.length];
          calcMealNutrition(meal);
          doc.text(`${type}: ${meal.name} (${meal.grams}) - ${meal.cal} kcal | ${meal.protein}g protein`, 10, y);
          y += 8;
          if (y > 280) { doc.addPage(); y = 10; }
        });
        y += 5;
      }
      doc.save("MealPlan.pdf");
    }
  </script>
</body>
</html>o
