<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BMI & Meal Planner</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
  .container { background: #fff; padding: 20px; border-radius: 8px; }
  input, select, button { width: 100%; padding: 8px; margin: 6px 0; }
  h2 { margin-top: 20px; }
  .meal { background: #eef; padding: 10px; margin: 5px 0; border-radius: 5px; }
</style>
</head>
<body>
<div class="container">
<h1>BMI & Meal Planner</h1>

<div id="step1">
  <h2>Step 1: Your Details</h2>
  <label>Height (cm):</label>
  <input type="number" id="height">

  <label>Weight (kg):</label>
  <input type="number" id="weight">

  <label>Age:</label>
  <input type="number" id="age">

  <label>Gender:</label>
  <select id="gender">
    <option value="male">Male</option>
    <option value="female">Female</option>
  </select>

  <button onclick="calculateBMI()">Next</button>
</div>

<div id="step2" style="display:none;">
  <h2>Step 2: Your Goals & Allergies</h2>
  <label>Weight Goal:</label>
  <select id="goal">
    <option value="lose">Lose weight</option>
    <option value="maintain">Maintain weight</option>
    <option value="gain">Gain muscle</option>
  </select>

  <label>Allergies (comma separated):</label>
  <input type="text" id="allergies">

  <button onclick="generatePlan()">Generate Meal Plan</button>
</div>

<div id="result" style="display:none;">
  <h2>Your BMI & Macros</h2>
  <p id="bmiResult"></p>
  <p id="macroResult"></p>

  <h2>Weekly Meal Plan</h2>
  <div id="mealPlan"></div>
</div>
</div>

<script>
function calculateBMI() {
    let h = parseFloat(document.getElementById("height").value) / 100;
    let w = parseFloat(document.getElementById("weight").value);
    if (!h || !w) { alert("Please enter height and weight"); return; }
    let bmi = (w / (h*h)).toFixed(1);
    document.getElementById("bmiResult").innerText = `Your BMI is ${bmi} (${bmiStatus(bmi)})`;
    document.getElementById("step1").style.display = "none";
    document.getElementById("step2").style.display = "block";
}

function bmiStatus(bmi) {
    if (bmi < 18.5) return "Underweight";
    if (bmi < 25) return "Normal weight";
    if (bmi < 30) return "Overweight";
    return "Obese";
}

function generatePlan() {
    let goal = document.getElementById("goal").value;
    let allergies = document.getElementById("allergies").value.toLowerCase().split(",").map(a => a.trim());
    
    let macros = {
        lose: "Protein: 150g, Carbs: 150g, Fat: 50g",
        maintain: "Protein: 140g, Carbs: 200g, Fat: 60g",
        gain: "Protein: 160g, Carbs: 250g, Fat: 70g"
    };
    document.getElementById("macroResult").innerText = `Target Macros: ${macros[goal]}`;

    let meals = [
        "Grilled chicken with quinoa and broccoli",
        "Salmon with brown rice and spinach",
        "Beef stir-fry with mixed vegetables",
        "Tofu salad with chickpeas and avocado",
        "Egg omelette with whole wheat toast",
        "Turkey wrap with lettuce and tomato",
        "Protein shake with banana and oats"
    ];

    // Filter out allergies
    let filteredMeals = meals.filter(meal => 
        !allergies.some(allergy => allergy && meal.toLowerCase().includes(allergy))
    );

    let mealPlanHTML = "";
    for (let i = 0; i < 7; i++) {
        mealPlanHTML += `<div class="meal"><strong>Day ${i+1}:</strong> ${filteredMeals[i % filteredMeals.length]}</div>`;
    }
    document.getElementById("mealPlan").innerHTML = mealPlanHTML;

    document.getElementById("step2").style.display = "none";
    document.getElementById("result").style.display = "block";
}
</script>
</body>
</html>
